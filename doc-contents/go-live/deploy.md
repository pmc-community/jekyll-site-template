---
layout: page
title: Deploy
permalink: /go-live/deploy/
categories: [Start, Go live]
tags: [appearance, build, test, deploy]
parent: Go live
nav_order: 3
---

# Summary
Deploying the site means to update the production environment (such as on-prem, or Github pages or Netlify, or similar). This is the next step after building and testing the site. It is strongly recommended to not build the site directly in the production environment, mostly when this environment is hosted by Github pages or Netlify or similar (build time can be long and can consume CI/CD minutes for tasks that are not necessary to be executed in production environment). 

In essence, deploying means to move the assets generated by the site build process to their final destination, the place targeted by the site production URL defined as environment variable, under the key `DEPLOY_PROD_BASE_URL`. This final place can be on a private infrastructure/server or hosted by Github pages or Netlify or other similar hosting solutions.

The deployment process depends on the production environment option. Docaroo provides out-of-the-box actions to deploy on Github pages and on Netlify.

# Limitations

{% include elements/alert.html 
  class="warning" 
  content="Multilanguage deployment is provided out-of-the-box only for Github pages. For other types of production environment, multilanguage deployment must be handled as per the specifics of that environment. In essence, each language variant is a separated instance of the site, accessible under `<site_url>/<lang-code>`, thus configuring this should not raise any issue in any production environment."
  title="Multilanguage" 
%}

{% capture c %}
  {% 
    ExternalRepoContent  { 
        "markdown": true,
        "owner":"pmc-community", 
        "repo":"jekyll-site-template", 
        "branch":"gh-pages", 
        "file_path":"doc-contents/go-live/algolia-doc-search-limitation.md", 
        "ignore_wp_shortcodes": true, 
        "start_marker": "fullFile",
        "include_start_marker": false,
        "end_marker": "fullFile" ,
        "include_end_marker": false,
        "needAuth": false
    }
%}
{% endcapture %}
{% include elements/alert.html class="warning" content=c title="Search in docs" %}

# Environment variables
The environment variables used for the deployment process are shown next:

```yml
{% 
    ExternalRepoContent  { 
        "markdown": true,
        "owner":"pmc-community", 
        "repo":"jekyll-site-template", 
        "branch":"gh-pages", 
        "file_path":".github/workflows/deploy-site-multilang-no-py.yml", 
        "ignore_wp_shortcodes": true, 
        "start_marker": "env:",
        "include_start_marker": false,
        "end_marker": "- name:" ,
        "include_end_marker": false,
        "needAuth": false
    }
%}
```
When deploying on Github pages or Netlify, please consult the related documentation for understanding how to create the Github repository action secrets or Netlify build environment variables.

{% capture img %}
    source="partials/media/deploy/ghp-env-var.png"|caption="Github secrets"|captionBorder="true"|imgLink="https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets"|imgLinkNewTab="true",
    source="partials/media/deploy/netlify-env-var.png"|caption="Netlify env vars"|captionBorder="true"|imgLink="https://docs.netlify.com/build/environment-variables/overview"|imgLinkNewTab="true"
{% endcapture %}

{% include elements/image-gallery.html 
  img=img 
  border="false" 
  hg="400px"
  oneRow="all" 
%}

{% include elements/link-btn.html 
    type="warning" 
    outline="false" 
    text="Env. variables" 
    href="/get-started/env/" 
    newTab="true" 
%}

# Github pages
Before deploying on Github pages it is necessary to configure the pages for the site repository.

{% include elements/alert.html 
  class="primary" 
  content="Please consult [Github pages documentation](https://docs.github.com/en/pages){: target=\"_blank\"} to understand how to configure it for the site repository and for the site domain."
  title="Github pages" 
%}

Deployment on Github pages is provided out-of-the-box by a deployment action. 

{% DirStructure .github/workflows %}

The action used for Github pages deployment is `deploy-site-multilang-no-py.yml` ans is named `(NO-PY) Manual Deploy Multilingual Jekyll site to Pages`. This action is designed to perform the minimum needed processing of the content for production and for deploying a multilanguage site (each language variant being hosted in a dedicated repository branch named with the two-digit language code). It is also designed to `not executing` the time consuming building tasks (the ones based on using Huggingface models or using intensive Python content processing), thus we emphasise again that `ALWAYS BUILD AND TEST THE SITE IN THE DEVELOPMENT ENVIRONMENT BEFORE DEPLOYING TO PRODUCTION`.

{% include elements/youtube.html 
    id="OzPopskhjL8" 
    width="640" 
    height="360"
%}

It is seen that the deploy action is triggered manually. Of course, at any time, the action trigger can be modified in order to start the deployment automatically (i.e. when new content is pushed to the `gh-pages` or any `language branch`) or scheduled (if your Github plan allows to schedule actions).

{% include elements/alert.html 
  class="warning" 
  content="It is strongly recommended to avoid automatic deploy action trigger on content push, mostly when the content is created in a collaborative way by many authors. The best option is to trigger it manually (as provided by default) or scheduled (once per week if there are relevant content updates)"
  title="GHP Deploy" 
%}

# Netlify
Before deploying on Netlify it is necessary to configure the environment for the site repository. Builds

{% include elements/alert.html 
  class="primary" 
  content="Please consult [Netlify documentation](https://docs.netlify.com/manage/domains/manage-domains/assign-a-domain-to-your-site-app){: target=\"_blank\"} to understand how to configure it for the site repository and for the site domain."
  title="Github pages" 
%}

{% include elements/youtube.html 
    id="bOkA8w7muEA" 
    width="640" 
    height="360"
%}

Deployment to Netlify is even more straight forward than deployment on Github pages. Once the Netlify site is connected to the site repository (to the production branch of your choice) and the environment variables are set, builds are automatically triggered when push on the production branch.

{% include elements/alert.html 
  class="warning" 
  content="It is strongly recommended to create a separated production branch in your repository and to merge any other development branches into it, manually or scheduled to avoid triggering a build each time when the content changes, thus minimising the CI/CD pipeline time consumption."
  title="Netlify production branch" 
%}

One important reason to choose Netlify as production environment is that, even in the free plan, Netlify provides a solution to have a backend (Netlify functions) and this can open many opportunities to further extend the functionality.